{% extends "base.html" %}
{% block title %}–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞{% endblock %}
{% block content %}
<h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ñ–µ—Ä–º–µ—Ä—Å–∫–∏–º —Ä—ã–Ω–∫–∞–º</h2>

<div style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 25px;">
    <div style="background: #f0f8f0; padding: 15px; border-radius: 6px; min-width: 180px;">
        <h3 style="margin: 0; color: #2c6f00;">{{ stats.total_markets }}</h3>
        <p style="margin: 5px 0 0; color: #555;">–í—Å–µ–≥–æ —Ä—ã–Ω–∫–æ–≤</p>
    </div>
    <div style="background: #f0f8f0; padding: 15px; border-radius: 6px; min-width: 180px;">
        <h3 style="margin: 0; color: #2c6f00;">{{ stats.total_reviews }}</h3>
        <p style="margin: 5px 0 0; color: #555;">–í—Å–µ–≥–æ –æ—Ç–∑—ã–≤–æ–≤</p>
    </div>
    <div style="background: #f0f8f0; padding: 15px; border-radius: 6px; min-width: 180px;">
        <h3 style="margin: 0; color: #2c6f00;">{{ "%.2f"|format(stats.avg_rating) }}</h3>
        <p style="margin: 5px 0 0; color: #555;">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</p>
    </div>
    <div style="background: #f0f8f0; padding: 15px; border-radius: 6px; min-width: 180px;">
        <h3 style="margin: 0; color: #2c6f00;">{{ stats.total_products }}</h3>
        <p style="margin: 5px 0 0; color: #555;">–ü—Ä–æ–¥—É–∫—Ç–æ–≤</p>
    </div>
    <div style="background: #f0f8f0; padding: 15px; border-radius: 6px; min-width: 180px;">
        <h3 style="margin: 0; color: #2c6f00;">{{ stats.total_payments }}</h3>
        <p style="margin: 5px 0 0; color: #555;">–°–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã</p>
    </div>
    <div style="background: #f0f8f0; padding: 15px; border-radius: 6px; min-width: 180px;">
        <h3 style="margin: 0; color: #2c6f00;">{{ stats.total_socials }}</h3>
        <p style="margin: 5px 0 0; color: #555;">–°–æ—Ü—Å–µ—Ç–µ–π</p>
    </div>
</div>

<h3>üèÜ –¢–æ–ø-5 —Ä—ã–Ω–∫–æ–≤ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É</h3>
{% if stats.top_markets %}
<table>
    <thead>
        <tr>
            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
            <th>–ì–æ—Ä–æ–¥</th>
            <th>–°—É–±—ä–µ–∫—Ç</th>
            <th>–†–µ–π—Ç–∏–Ω–≥</th>
            <th>–û—Ç–∑—ã–≤–æ–≤</th>
        </tr>
    </thead>
    <tbody>
        {% for m in stats.top_markets %}
        <tr>
            <td>{{ m.market_name }}</td>
            <td>{{ m.city }}</td>
            <td>{{ m.state }}</td>
            <td>‚òÖ {{ "%.2f"|format(m.avg_rating) }}</td>
            <td>{{ m.review_count }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>–ù–µ—Ç —Ä—ã–Ω–∫–æ–≤ —Å –æ—Ç–∑—ã–≤–∞–º–∏.</p>
{% endif %}

<h3>üìç –†—ã–Ω–∫–∏ –ø–æ —Å—É–±—ä–µ–∫—Ç–∞–º (—Ç–æ–ø-10)</h3>
{% if stats.markets_by_state %}
<table>
    <thead>
        <tr>
            <th>–°—É–±—ä–µ–∫—Ç</th>
            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä—ã–Ω–∫–æ–≤</th>
        </tr>
    </thead>
    <tbody>
        {% for s in stats.markets_by_state %}
        <tr>
            <td>{{ s.state or "‚Äî"}} </td>
            <td>{{ s.count }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö.</p>
{% endif %}

<a href="{{ url_for('markets') }}" class="btn">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
{% endblock %}