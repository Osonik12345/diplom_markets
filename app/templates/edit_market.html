{% extends "base.html" %}
{% block title %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä—ã–Ω–æ–∫{% endblock %}
{% block content %}
<h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–µ—Ä–º–µ—Ä—Å–∫–∏–π —Ä—ã–Ω–æ–∫</h2>

<form method="GET">
    <input type="text" name="name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ä—ã–Ω–∫–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è" value="{{ request.args.get('name', '') }}" required>
    <button type="submit" class="btn">üîç –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
</form>

{% if market %}
<div class="message info" style="background:#e8f5e9; color:#1b5e20; margin: 15px 0;">
    üìù –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Ä—ã–Ω–æ–∫: <strong>{{ market.market_name }}</strong> (–Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–µ–ª—å–∑—è)
</div>

<form method="POST">
    <input type="hidden" name="market_id" value="{{ market.market_id }}">
    <input type="hidden" name="original_name" value="{{ market.market_name }}">

    <label>–£–ª–∏—Ü–∞ *</label>
    <input type="text" name="street" value="{{ market.street }}" required>

    <label>–ì–æ—Ä–æ–¥ *</label>
    <input type="text" name="city" value="{{ market.city }}" required>

    <label>–°—É–±—ä–µ–∫—Ç *</label>
    <input type="text" name="state" value="{{ market.state }}" required>

    <label>–ò–Ω–¥–µ–∫—Å *</label>
    <input type="text" name="zip" value="{{ market.zip }}" required>

    <label>–î–æ–ª–≥–æ—Ç–∞ (x)</label>
    <input type="number" step="any" name="x" value="{{ market.x if market.x is not none else '' }}">

    <label>–®–∏—Ä–æ—Ç–∞ (y)</label>
    <input type="number" step="any" name="y" value="{{ market.y if market.y is not none else '' }}">

    <label>–û–ø–∏—Å–∞–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è</label>
    <textarea name="location">{{ market.location }}</textarea>

    <h3>–¢–æ–≤–∞—Ä—ã</h3>
    {% for p in products %}
        <label>
            <input type="checkbox" name="products" value="{{ p.product_id }}"
                {% if p.product_id in market.selected_products %}checked{% endif %}>
            {{ p.product_name }}
        </label>
    {% endfor %}

    <h3>–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã</h3>
    {% for p in payments %}
        <label>
            <input type="checkbox" name="payments" value="{{ p.payment_id }}"
                {% if p.payment_id in market.selected_payments %}checked{% endif %}>
            {{ p.payment_name }}
        </label>
    {% endfor %}

    <h3>–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</h3>
    {% for sn in social_networks %}
        <div style="margin-bottom: 8px;">
            <label>
                <input type="checkbox" name="social_networks" value="{{ sn.social_network_id }}"
                    {% if sn.social_network_id in market.social_links %}checked{% endif %}>
                {{ sn.social_networks }}
            </label>
            <input type="text" name="social_urls"
                value="{{ market.social_links.get(sn.social_network_id, '') }}"
                placeholder="URL –ø—Ä–æ—Ñ–∏–ª—è"
                style="margin-left: 10px; width: 250px;">
        </div>
    {% endfor %}

    <button type="submit" class="btn green">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
    <a href="{{ url_for('markets') }}" class="btn">‚Üê –û—Ç–º–µ–Ω–∞</a>
</form>
{% endif %}
{% endblock %}